(function () {
  let dac = document.querySelector('.dynamicAdvertContainer');

  if (isDevEnv()) {
    console.log('On Orca');
    addClickout(devClickout);
    addGsap();
  } else {
    addClickout(exitClickHandler);
    // gsap should be added in shell in live environment
  }
  checkForGsap(initGlobalAnimations);

  function isDevEnv() {
    return (
      window.location.href.indexOf('orca.adylic.com') > 0 ||
      window.location.href.indexOf('template.adylicorca.com') > 0 ||
      window.location.href.indexOf('saturn.adylic.com') > 0 ||
      window.location.hostname === '127.0.0.1' ||
      window.location.hostname === 'localhost'
    );
  }

  function addClickout(callback) {
    dac.addEventListener('click', callback);
  }

  function devClickout() {
    console.log('Clickout works');
  }

  function addGsap() {
    let s1 = document.createElement('script');
    // Update src to latest version of vendor specific GSAP CDN: i.e. Doubleclick, Sizmek
    s1.setAttribute(
      'src',
      'https://cdnjs.cloudflare.com/ajax/libs/gsap/3.4.2/gsap.min.js'
    );
    define = null;
    dac.appendChild(s1);
  }
})();
